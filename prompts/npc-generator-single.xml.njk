<template>
    <role>Ad-Hoc NPC Generator</role>

    <systemPrompt>
You are an experienced AI game master who writes concise XML data about non-player characters for a narrative-driven RPG. Maintain internal consistency with the setting details provided and avoid reusing banned NPC names.
    </systemPrompt>

    <generationPrompt>
<context>
<setting>
  <name>{{ setting.name }}</name>
  <description>{{ setting.description }}</description>
  <theme>{{ setting.theme }}</theme>
  <genre>{{ setting.genre }}</genre>
  <startingLocationType>{{ setting.startingLocationType }}</startingLocationType>
  <magicLevel>{{ setting.magicLevel }}</magicLevel>
  <techLevel>{{ setting.techLevel }}</techLevel>
  <tone>{{ setting.tone }}</tone>
  <difficulty>{{ setting.difficulty }}</difficulty>
  <currencyName>{{ setting.currencyName }}</currencyName>
  <currencyNamePlural>{{ setting.currencyNamePlural }}</currencyNamePlural>
  <currencyValueNotes>{{ setting.currencyValueNotes }}</currencyValueNotes>
  <writingStyleNotes>{{ setting.writingStyleNotes }}</writingStyleNotes>
</setting>
<region>
<name>{{ region.name }}</name>
<description>{{ region.description }}</description>
</region>
<location>
<name>{{ location.name }}</name>
<description>{{ location.description }}</description>
</location>
<existingNpcs>
{% for npc in existingNpcSummaries %}- {{ npc.name }}: {{ npc.shortDescription }}
{% endfor %}
</existingNpcs>
<deceasedNpcs>
{% include "_includes/npc-banlist.njk" %}
</deceasedNpcs>
</context>

Generate exactly one NPC entry for the character named "{{ npcName }}". Use the XML structure below and keep the <name> element exactly "{{ npcName }}". The NPC must feel grounded in the location and setting, with clear motivations or hooks for interaction.

<npcs>
  <npc>
    <name>{{ npcName }}</name>
    <description>Three sentences describing appearance, personality, current goals, and how they relate to the location.</description>
    <shortDescription>Ten words or fewer summarizing the NPC.</shortDescription>
    <role>Clear role, job, or niche within the location.</role>
    <class>RPG class, vocation, or archetype.</class>
    <race>Species or origin.</race>
    <relativeLevel>Integer from -3 to +3</relativeLevel>
    <currency>Integer amount of currency the NPC has on hand, based on setting norms.</currency>
    <attributes>
{% for attrName, attrDef in attributeDefinitions %}      <attribute name="{{ attrName }}">Rating using: poor, below average, average, above average, excellent, or legendary.</attribute>
{% endfor %}
    </attributes>
    <personality>
        <type>Myers-Briggs type, -dere archetype, Enneagram type, DnD alignment, or "automaton", as appropriate -- whatever works best. Optionally, 2 types separated by commas, so long as they make sense together.</type>
        <traits>optionally, any neurodivergences or mental health conditions (e.g. ADHD, autism, anxiety, depression, bipolar, PTSD, sociopathy, psychopathy, mania, any phobias, etc). Comma separated, usually none, no more than 3</traits>
        <notes>0 to 2 sentences of additional information not covered by the above that's unique to the character</notes>
    </personality>
    <healthAttribute>Name of the attribute (from the list) that determines health gained at level up. Usually something related to toughness or stamina, but may differ for particularly strange npcs or creatures</healthAttribute>
  </npc>
</npcs>

Do not include any additional <npc> entries or stray from the XML format.
    </generationPrompt>
</template>
