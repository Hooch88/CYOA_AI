<?xml version="1.0" encoding="UTF-8"?>
<template>
    <role>Location Expander</role>
    <description>Expand an existing stubbed location into a full playable area</description>
    
    <systemPrompt>
You are an AI assistant that expands partially discovered locations in a fantasy RPG world. Using the provided context, fully develop the destination so it seamlessly connects to its origin area.
    </systemPrompt>
    
    <generationPrompt>
<context>
<setting>
{{ setting }}
</setting>

{% if originLocationName or originDescription %}
<originLocation>
  {% if originLocationName %}<name>{{ originLocationName }}</name>{% endif %}
  {% if originDirection %}<direction>{{ originDirection }}</direction>{% endif %}
  {% if originDescription %}<description>{{ originDescription }}</description>{% endif %}
</originLocation>
{% endif %}

{% if stubName or stubId %}
<stub>
  {% if stubId %}<id>{{ stubId }}</id>{% endif %}
  {% if stubName %}<name>{{ stubName }}</name>{% endif %}
</stub>
{% endif %}
</context>

<instructions>Expand the stubbed destination into a fully realized location that feels like a natural continuation of the origin area{% if originDirection %} reached by travelling {{ originDirection }}{% endif %}. Maintain continuity with the origin's tone, scale, and environmental storytelling.</instructions>

REQUIRED FIELDS:
- name: Preserve the existing stub name if provided unless a slight refinement improves clarity.
- description: Provide 1-3 rich paragraphs describing the area, referencing how it connects back to the origin location and suggesting onward paths for future exploration.
- baseLevel: Integer from 1-20 reflecting the challenge of this location.

OPTIONAL CONTEXT (if provided):
{% if shortDescription -%}
- Short Description: {{ shortDescription }}
{% endif -%}
{% if locationTheme -%}
- Theme/Setting: {{ locationTheme }}
{% endif -%}
{% if playerLevel -%}
- Appropriate for player level: {{ playerLevel }}
{% endif -%}
{% if locationPurpose -%}
- Purpose in story: {{ locationPurpose }}
{% endif -%}

GUIDELINES:
- Reference sensory details and story hooks that bridge to and from the origin location.
- Mention at least one notable feature that hints at additional unexplored directions.
- Ensure the description makes sense even if the player arrived without prior knowledge beyond the origin.

OUTPUT FORMAT:
Return ONLY the following fields, in this format:

<location>
  <name>The final name for the expanded location</name>
  <description>
    <p>up to 3 paragraphs of description</p>
    <p>[...]</p>
  </description>
</location>
    </generationPrompt>
</template>
